\RequirePackage{etex}
\makeatletter
\ifx \nauthor\undefined
\def\nauthor{Leqi Xu}
\else
\fi

\author{Based on lectures by \nlecturer \\\small Notes taken by \nauthor}
\date{\nyear\ \nterm}

\usepackage{etoolbox}
\usepackage{alltt}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{bbding}
\usepackage{bbm}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{mathdots}
\usepackage{mathtools}
\usepackage{microtype}
\usepackage{multirow}
\usepackage{pdflscape}
\usepackage{pgfplots}
\usepackage{siunitx}
\usepackage{textcomp}
\usepackage{slashed}
\usepackage{tabularx}
\usepackage{tikz}
\usepackage{tkz-euclide}
\usepackage[normalem]{ulem}
\usepackage[all]{xy}
\usepackage{imakeidx}
\usepackage{enumitem}

\makeindex[intoc, title=Index]
\indexsetup{othercode={\lhead{\emph{Index}}}}

\ifx \nextra \undefined
\usepackage[hidelinks,
pdfauthor={Leqi Xu},
pdfsubject={\npart\ : \ncourse},
pdftitle={\npart\ : \ncourse},
pdfkeywords={\npart\ : \ncourse\ \nyear\ \nterm}]{hyperref}
\title{\npart\ :  \ncourse}
\else
\usepackage[hidelinks,
pdfauthor={Leqi Xu},
pdfsubject={\npart\ : \ncourse\ (\nextra)},
pdftitle={\npart\ : \ncourse\ (\nextra)},
pdfkeywords={\npart\ : \ncourse\ \nyear\ \nterm\ \nextra}]{hyperref}

\title{\npart\ : \ncourse \\ {\Large \nextra}}
\renewcommand\printindex{}
\fi

\pgfplotsset{compat=1.12}

\pagestyle{fancyplain}{\pagestyle{fancy} \fancyhead[R]{\leftmark}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
\ifx \ncoursehead \undefined
\def\ncoursehead{\ncourse}
\fi

\lhead{\emph{\nouppercase{\rightmark}}}

\ifx \nextra \undefined
\rhead{
	\ifnum\thepage=1
	\else
	\npart\ \ncoursehead
	\fi}
\else
\rhead{
	\ifnum\thepage=1
	\else
	\npart\ \ncoursehead \ (\nextra)
	\fi}
\fi

\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{positioning}
\usetikzlibrary{fadings}
\usetikzlibrary{intersections}
\usetikzlibrary{cd}

\newcommand*{\Cdot}{{\raisebox{-0.25ex}{\scalebox{1.5}{$\cdot$}}}}
\newcommand {\pd}[2][ ]{
	\ifx #1 { }
	\frac{\partial}{\partial #2}
	\else
	\frac{\partial^{#1}}{\partial #2^{#1}}
	\fi
}
\ifx \nhtml \undefined
\else
\renewcommand\printindex{}
\DisableLigatures[f]{family = *}
\let\Contentsline\contentsline
\renewcommand\contentsline[3]{\Contentsline{#1}{#2}{}}
\renewcommand{\@dotsep}{10000}
\newlength\currentparindent
\setlength\currentparindent\parindent

\newcommand\@minipagerestore{\setlength{\parindent}{\currentparindent}}
\usepackage[active,tightpage,pdftex]{preview}
\renewcommand{\PreviewBorder}{0.1cm}

\newenvironment{stretchpage}%
{\begin{preview}\begin{minipage}{\hsize}}%
		{\end{minipage}\end{preview}}
\AtBeginDocument{\begin{stretchpage}}
	\AtEndDocument{\end{stretchpage}}

\newcommand{\@@newpage}{\end{stretchpage}\begin{stretchpage}}

\let\@real@section\section
\renewcommand{\section}{\@ifstar{\@real@section*}{\@@newpage\@real@section}
\let\@real@subsection\subsection
\renewcommand{\subsection}{\@ifstar{\@real@subsection*}{\@@newpage\@real@subsection}}
\fi
\ifx \ntrim \undefined
\else
\usepackage{geometry}
\geometry{
	papersize={379pt, 699pt},
	textwidth=345pt,
	textheight=596pt,
	left=17pt,
	top=54pt,
	right=17pt
}
\fi

% Theorems
\theoremstyle{definition}
\newtheorem{claim}{Claim}
\newtheorem{cor}{Corollary}
\newtheorem{conjecture}{Conjecture}
\newtheorem{defi}{Definition}
\newtheorem{defi*}{Definition}
\newtheorem{eg}{Example}
\newtheorem{eg*}{Example}
\newtheorem{ex}{Exercise}
\newtheorem{fact}{Fact}
\newtheorem{law}{Law}
\newtheorem{lemma}{Lemma}
\newtheorem{notation}{Notation}
\newtheorem{prop}{Proposition}
\newtheorem{question}{Question}
\newtheorem{question*}{Question}
\newtheorem{answer}{Answer}
\newtheorem{answer*}{Answer}
\newtheorem{problem}{Problem}
\newtheorem{rrule}{Rule}
\newtheorem{thm}{Theorem}
\newtheorem{thm*}{Theorem}
\newtheorem{assumption}{Assumption}

\newtheorem{remark}{Remark}
\newtheorem{note}{Note}
\newtheorem*{note*}{Note}
\newtheorem{warning}{Warning}
\newtheorem{exercise}{Exercise}

\newtheorem{nthm}{Theorem}[section]
\newtheorem{nlemma}[nthm]{Lemma}
\newtheorem{nprop}[nthm]{Proposition}
\newtheorem{ncor}[nthm]{Corollary}

\numberwithin{equation}{subsection}
\numberwithin{claim}{subsection}
\numberwithin{cor}{subsection}
\numberwithin{conjecture}{subsection}
\numberwithin{defi}{subsection}
\numberwithin{eg}{subsection}
\numberwithin{ex}{subsection}
\numberwithin{fact}{subsection}
\numberwithin{law}{subsection}
\numberwithin{lemma}{subsection}
\numberwithin{notation}{subsection}
\numberwithin{prop}{subsection}
\numberwithin{question}{subsection}
\numberwithin{answer}{subsection}
\numberwithin{problem}{subsection}
\numberwithin{rrule}{subsection}
\numberwithin{thm}{subsection}
\numberwithin{assumption}{subsection}

\numberwithin{note}{subsection}
\numberwithin{remark}{subsection}
\numberwithin{warning}{subsection}
\numberwithin{exercise}{subsection}

\renewcommand{\labelitemi}{--}
\renewcommand{\labelitemii}{$\circ$}
\renewcommand{\labelenumi}{(\roman{*})}

\let\stdsection\section
\renewcommand\section{\newpage\stdsection}

% Strike through
\def\st{\bgroup \ULdepth=-.55ex \ULset}


%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Maths Symbols %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%

\let\U\relax
\let\C\relax
\let\G\relax

% Matrix groups
\newcommand{\GL}{\mathrm{GL}}
\newcommand{\Or}{\mathrm{O}}
\newcommand{\PGL}{\mathrm{PGL}}
\newcommand{\PSL}{\mathrm{PSL}}
\newcommand{\PSO}{\mathrm{PSO}}
\newcommand{\PSU}{\mathrm{PSU}}
\newcommand{\SL}{\mathrm{SL}}
\newcommand{\SO}{\mathrm{SO}}
\newcommand{\Spin}{\mathrm{Spin}}
\newcommand{\Sp}{\mathrm{Sp}}
\newcommand{\SU}{\mathrm{SU}}
\newcommand{\U}{\mathrm{U}}
\newcommand{\Mat}{\mathrm{Mat}}

% Matrix algebras
\newcommand{\gl}{\mathfrak{gl}}
\newcommand{\ort}{\mathfrak{o}}
\newcommand{\so}{\mathfrak{so}}
\newcommand{\su}{\mathfrak{su}}
\newcommand{\uu}{\mathfrak{u}}
\renewcommand{\sl}{\mathfrak{sl}}

% Special sets
\newcommand{\C}{\mathbb{C}}
\newcommand{\CP}{\mathbb{CP}}
\newcommand{\GG}{\mathbb{G}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\RP}{\mathbb{RP}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\Z}{\mathbb{Z}}
\renewcommand{\H}{\mathbb{H}}

% Brackets
\newcommand{\abs}[1]{\left\lvert #1\right\rvert}
\newcommand{\bket}[1]{\left\lvert #1\right\rangle}
\newcommand{\brak}[1]{\left\langle #1 \right\rvert}
\newcommand{\braket}[2]{\left\langle #1\middle\vert #2 \right\rangle}
\newcommand{\bra}{\langle}
\newcommand{\ket}{\rangle}
\newcommand{\norm}[1]{\left\lVert #1\right\rVert}
\newcommand{\normalorder}[1]{\mathop{:}\nolimits\!#1\!\mathop{:}\nolimits}
\newcommand{\tv}[1]{|#1|}
\renewcommand{\vec}[1]{\boldsymbol{\mathbf{#1}}}

% not-math
\newcommand{\bolds}[1]{{\bfseries #1}}
\newcommand{\cat}[1]{\mathsf{#1}}
\newcommand{\ph}{\,\cdot\,}
\newcommand{\term}[1]{\emph{#1}\index{#1}}
\newcommand{\phantomeq}{\hphantom{{}={}}}

% Probability
\DeclareMathOperator{\Bernoulli}{Bernoulli}
\DeclareMathOperator{\betaD}{beta}
\DeclareMathOperator{\bias}{bias}
\DeclareMathOperator{\binomial}{binomial}
\DeclareMathOperator{\corr}{corr}
\DeclareMathOperator{\cov}{cov}
\DeclareMathOperator{\gammaD}{gamma}
\DeclareMathOperator{\mse}{mse}
\DeclareMathOperator{\multinomial}{multinomial}
\DeclareMathOperator{\Poisson}{Poisson}
\DeclareMathOperator{\var}{var}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Prob}{\mathbb{P}}

% Algebra
\DeclareMathOperator{\adj}{adj}
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Char}{char}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\fix}{fix}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\image}{image}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\re}{re}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\Tr}{Tr}
\newcommand{\Bilin}{\mathrm{Bilin}}
\newcommand{\Frob}{\mathrm{Frob}}

% Others
\newcommand\ad{\mathrm{ad}}
\newcommand\Art{\mathrm{Art}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\Der}{\mathrm{Der}}
\newcommand{\D}{\mathrm{D}}
\newcommand{\dR}{\mathrm{dR}}
\newcommand{\exterior}{\mathchoice{{\textstyle\bigwedge}}{{\bigwedge}}{{\textstyle\wedge}}{{\scriptstyle\wedge}}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\Gr}{\mathrm{Gr}}
\newcommand{\haut}{\mathrm{ht}}
\newcommand{\Hol}{\mathrm{Hol}}
\newcommand{\hol}{\mathfrak{hol}}
\newcommand{\Id}{\mathrm{Id}}
\newcommand{\lie}[1]{\mathfrak{#1}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\Oc}{\mathcal{O}}
\newcommand{\pr}{\mathrm{pr}}
\newcommand{\Ps}{\mathcal{P}}
\newcommand{\pt}{\mathrm{pt}}
\newcommand{\qeq}{\mathrel{``{=}"}}
\newcommand{\Rs}{\mathcal{R}}
\newcommand{\Vect}{\mathrm{Vect}}
\newcommand{\wsto}{\stackrel{\mathrm{w}^*}{\to}}
\newcommand{\wt}{\mathrm{wt}}
\newcommand{\wto}{\stackrel{\mathrm{w}}{\to}}
\renewcommand{\d}{\mathrm{d}}
\renewcommand{\P}{\mathbb{P}}
%\renewcommand{\F}{\mathcal{F}}


\let\Im\relax
\let\Re\relax

\DeclareMathOperator{\area}{area}
\DeclareMathOperator{\card}{card}
\DeclareMathOperator{\ccl}{ccl}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\cl}{cl}
\DeclareMathOperator{\cls}{\overline{\mathrm{span}}}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\cosec}{cosec}
\DeclareMathOperator{\cosech}{cosech}
\DeclareMathOperator{\covol}{covol}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\energy}{energy}
\DeclareMathOperator{\erfc}{erfc}
\DeclareMathOperator{\erf}{erf}
\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator{\ev}{ev}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\fst}{fst}
\DeclareMathOperator{\Fit}{Fit}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\hcf}{hcf}
\DeclareMathOperator{\Im}{Im}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\Int}{Int}
\DeclareMathOperator{\Isom}{Isom}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\length}{length}
\DeclareMathOperator{\Lie}{Lie}
\DeclareMathOperator{\like}{like}
\DeclareMathOperator{\Lk}{Lk}
\DeclareMathOperator{\Maps}{Maps}
\DeclareMathOperator{\orb}{orb}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\otp}{otp}
\DeclareMathOperator{\poly}{poly}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\rel}{rel}
\DeclareMathOperator{\Rad}{Rad}
\DeclareMathOperator{\Re}{Re}
\DeclareMathOperator*{\res}{res}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\Ric}{Ric}
\DeclareMathOperator{\rk}{rk}
\DeclareMathOperator{\Rees}{Rees}
\DeclareMathOperator{\Root}{Root}
\DeclareMathOperator{\sech}{sech}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\snd}{snd}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\spn}{span}
\DeclareMathOperator{\stab}{stab}
\DeclareMathOperator{\St}{St}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\vol}{vol}

\pgfarrowsdeclarecombine{twolatex'}{twolatex'}{latex'}{latex'}{latex'}{latex'}
\tikzset{->/.style = {decoration={markings,
			mark=at position 1 with {\arrow[scale=2]{latex'}}},
		postaction={decorate}}}
\tikzset{<-/.style = {decoration={markings,
			mark=at position 0 with {\arrowreversed[scale=2]{latex'}}},
		postaction={decorate}}}
\tikzset{<->/.style = {decoration={markings,
			mark=at position 0 with {\arrowreversed[scale=2]{latex'}},
			mark=at position 1 with {\arrow[scale=2]{latex'}}},
		postaction={decorate}}}
\tikzset{->-/.style = {decoration={markings,
			mark=at position #1 with {\arrow[scale=2]{latex'}}},
		postaction={decorate}}}
\tikzset{-<-/.style = {decoration={markings,
			mark=at position #1 with {\arrowreversed[scale=2]{latex'}}},
		postaction={decorate}}}
\tikzset{->>/.style = {decoration={markings,
			mark=at position 1 with {\arrow[scale=2]{latex'}}},
		postaction={decorate}}}
\tikzset{<<-/.style = {decoration={markings,
			mark=at position 0 with {\arrowreversed[scale=2]{twolatex'}}},
		postaction={decorate}}}
\tikzset{<<->>/.style = {decoration={markings,
			mark=at position 0 with {\arrowreversed[scale=2]{twolatex'}},
			mark=at position 1 with {\arrow[scale=2]{twolatex'}}},
		postaction={decorate}}}
\tikzset{->>-/.style = {decoration={markings,
			mark=at position #1 with {\arrow[scale=2]{twolatex'}}},
		postaction={decorate}}}
\tikzset{-<<-/.style = {decoration={markings,
			mark=at position #1 with {\arrowreversed[scale=2]{twolatex'}}},
		postaction={decorate}}}

\tikzset{circ/.style = {fill, circle, inner sep = 0, minimum size = 3}}
\tikzset{scirc/.style = {fill, circle, inner sep = 0, minimum size = 1.5}}
\tikzset{mstate/.style={circle, draw, blue, text=black, minimum width=0.7cm}}

\tikzset{eqpic/.style={baseline={([yshift=-.5ex]current bounding box.center)}}}
\tikzset{commutative diagrams/.cd,cdmap/.style={/tikz/column 1/.append style={anchor=base east},/tikz/column 2/.append style={anchor=base west},row sep=tiny}}

\definecolor{mblue}{rgb}{0.2, 0.3, 0.8}
\definecolor{morange}{rgb}{1, 0.5, 0}
\definecolor{mgreen}{rgb}{0.1, 0.4, 0.2}
\definecolor{mred}{rgb}{0.5, 0, 0}

\def\drawcirculararc(#1,#2)(#3,#4)(#5,#6){%
	\pgfmathsetmacro\cA{(#1*#1+#2*#2-#3*#3-#4*#4)/2}%
	\pgfmathsetmacro\cB{(#1*#1+#2*#2-#5*#5-#6*#6)/2}%
	\pgfmathsetmacro\cy{(\cB*(#1-#3)-\cA*(#1-#5))/%
		((#2-#6)*(#1-#3)-(#2-#4)*(#1-#5))}%
	\pgfmathsetmacro\cx{(\cA-\cy*(#2-#4))/(#1-#3)}%
	\pgfmathsetmacro\cr{sqrt((#1-\cx)*(#1-\cx)+(#2-\cy)*(#2-\cy))}%
	\pgfmathsetmacro\cA{atan2(#2-\cy,#1-\cx)}%
	\pgfmathsetmacro\cB{atan2(#6-\cy,#5-\cx)}%
	\pgfmathparse{\cB<\cA}%
	\ifnum\pgfmathresult=1
	\pgfmathsetmacro\cB{\cB+360}%
	\fi
	\draw (#1,#2) arc (\cA:\cB:\cr);%
}

\pgfmathdeclarefunction{gauss}{3}{%
	\pgfmathparse{1/(#3*sqrt(2*pi))*exp(-((#1-#2)^2)/(2*#3^2))}%
}
\pgfmathdeclarefunction{alpha}{2}{%
	\pgfmathparse{#2/(9-#1)}%
}

\newcommand\getCoord[3]{\newdimen{#1}\newdimen{#2}\pgfextractx{#1}{\pgfpointanchor{#3}{center}}\pgfextracty{#2}{\pgfpointanchor{#3}{center}}}

\newcommand\qedshift{\vspace{-17pt}}
\newcommand\fakeqed{\pushQED{\qed}\qedhere}

\def\Xint#1{\mathchoice
	{\XXint\displaystyle\textstyle{#1}}%
	{\XXint\textstyle\scriptstyle{#1}}%
	{\XXint\scriptstyle\scriptscriptstyle{#1}}%
	{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
	\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$}
		\vcenter{\hbox{$#2#3$}}\kern-.5\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

\newcommand\separator{{\centering\rule{2cm}{0.2pt}\vspace{2pt}\par}}

\newenvironment{own}{\color{gray!70!black}}{}

\newcommand\makecenter[1]{\raisebox{-0.5\height}{#1}}

\mathchardef\mdash="2D

\newenvironment{significant}{\begin{center}\begin{minipage}{0.9\textwidth}\centering\em}{\end{minipage}\end{center}}
\DeclareRobustCommand{\rvdots}{%
	\vbox{
		\baselineskip4\p@\lineskiplimit\z@
		\kern-\p@
		\hbox{.}\hbox{.}\hbox{.}
}}
\DeclareRobustCommand\tph[3]{{\texorpdfstring{#1}{#2}}}
\DeclareMathOperator*{\argmin}{\arg\!\min}
\DeclareMathOperator*{\argmax}{\arg\!\max}
\makeatother